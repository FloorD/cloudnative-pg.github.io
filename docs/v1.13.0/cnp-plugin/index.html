<!DOCTYPE html>




<html lang="en">

<head>
  <title>CloudNative PG</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta name="description" content="CloudNativePG is the Kubernetes operator that covers the full lifecycle of a highly available PostgreSQL database cluster with a primary/standby architecture, using native streaming replication." />
  <meta name="keywords" content="" />
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" />
  <link href="/main.min.css" rel="stylesheet" />
</head>

<body>
  <div class="h-screen w-screen">
    
<main>
  <header>
    <div class="flex flex-row px-16 justify-between py-5">
      <div>
        
        <a href="/"><img src="/logo/large_logo.svg" class="h-14" alt="Cloud Native Postgres Logo"></a>
      </div>
      <div>
        <ul class="flex gap-14 text-2xl text-slate-400 my-5">
          <li><a href="/docs/1.15.0/" target="_blank">Documentation</a></li>
          <li>Support</li>
          <li>End users</li>
          <li>Blog</li>
        </ul>
      </div>
      <div class="flex gap-5 my-4">
        <a href="https://github.com/cloudnative-pg/cloudnative-pg">
          <img src="/icons/Git.svg" alt="Github">
        </a>
        <a href="https://cloudnativepg.slack.com/">
          <img src="/icons/Slack.svg" alt="Slack">
        </a>
        <a href="https://twitter.com/CloudNativePg">
          <img src="/icons/Twitter.svg" alt="Twitter">
        </a>
        <a href="https://www.youtube.com/channel/UCTGH88W1BiuRRPTzJUDPJyA">
          <img src="/icons/YouTube.svg" alt="YouTube">
        </a>
      </div>
    </div>
  </header>
</main>


    
<h2 class="text-2xl"></h2>
<h1 id="cloud-native-postgresql-plugin">Cloud Native PostgreSQL Plugin</h1>
<p>Cloud Native PostgreSQL provides a plugin for <code>kubectl</code> to manage a cluster in Kubernetes.
The plugin also works with <code>oc</code> in an OpenShift environment.</p>
<h2 id="install">Install</h2>
<p>You can install the plugin in your system with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl -sSfL <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  https://github.com/EnterpriseDB/kubectl-cnp/raw/main/install.sh | <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  sudo sh -s -- -b /usr/local/bin
</span></span></code></pre></div><h3 id="supported-architectures">Supported Architectures</h3>
<p>Cloud Native PostgreSQL Plugin is currently build for the following operating system and architectures:</p>
<ul>
<li>Linux
<ul>
<li>amd64</li>
<li>arm 5/6/7</li>
<li>arm64</li>
<li>s390x</li>
<li>ppc64le</li>
</ul>
</li>
<li>macOS
<ul>
<li>amd64</li>
<li>arm64</li>
</ul>
</li>
<li>Windows
<ul>
<li>386</li>
<li>amd64</li>
<li>arm 5/6/7</li>
<li>arm64</li>
</ul>
</li>
</ul>
<h2 id="use">Use</h2>
<p>Once the plugin was installed and deployed, you can start using it like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp &lt;command&gt; &lt;args...&gt;
</span></span></code></pre></div><h3 id="status">Status</h3>
<p>The <code>status</code> command provides an overview of the current status of your
cluster, including:</p>
<ul>
<li><strong>general information</strong>: name of the cluster, PostgreSQL&rsquo;s system ID, number of
instances, current timeline and position in the WAL</li>
<li><strong>backup</strong>: point of recoverability, and WAL archiving status as returned by
the <code>pg_stat_archiver</code> view from the primary - or designated primary in the
case of a replica cluster</li>
<li><strong>streaming replication</strong>: information taken directly from the <code>pg_stat_replication</code>
view on the primary instance</li>
<li><strong>instances</strong>: information about each Postgres instance, taken directly by each
instance manager; in the case of a standby, the <code>Current LSN</code> field corresponds
to the latest write-ahead log location that has been replayed during recovery
(replay LSN).</li>
</ul>
<p>!!! Important
The status information above is taken at different times and at different
locations, resulting in slightly inconsistent returned values. For example,
the <code>Current Write LSN</code> location in the main header, might be different
from the <code>Current LSN</code> field in the instances status as it is taken at
two different time intervals.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp status sandbox
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Cluster in healthy state
</span></span><span style="display:flex;"><span>Name:               sandbox
</span></span><span style="display:flex;"><span>Namespace:          default
</span></span><span style="display:flex;"><span>System ID:          <span style="color:#ae81ff">7039966298120953877</span>
</span></span><span style="display:flex;"><span>PostgreSQL Image:   quay.io/enterprisedb/postgresql:14.1
</span></span><span style="display:flex;"><span>Primary instance:   sandbox-2
</span></span><span style="display:flex;"><span>Instances:          <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Ready instances:    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Current Write LSN:  3AF/EAFA6168 <span style="color:#f92672">(</span>Timeline: <span style="color:#ae81ff">8</span> - WAL File: 00000008000003AF00000075<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Continuous Backup status
</span></span><span style="display:flex;"><span>First Point of Recoverability:  Not Available
</span></span><span style="display:flex;"><span>Working WAL archiving:          OK
</span></span><span style="display:flex;"><span>Last Archived WAL:              00000008000003AE00000079   @   2021-12-14T10:16:29.340047Z
</span></span><span style="display:flex;"><span>Last Failed WAL: -
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Certificates Status
</span></span><span style="display:flex;"><span>Certificate Name             Expiration Date                Days Left Until Expiration
</span></span><span style="display:flex;"><span>----------------             ---------------                --------------------------
</span></span><span style="display:flex;"><span>cluster-example-ca           2022-05-05 15:02:42 +0000 UTC  87.23
</span></span><span style="display:flex;"><span>cluster-example-replication  2022-05-05 15:02:42 +0000 UTC  87.23
</span></span><span style="display:flex;"><span>cluster-example-server       2022-05-05 15:02:42 +0000 UTC  87.23
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Streaming Replication status
</span></span><span style="display:flex;"><span>Name       Sent LSN      Write LSN     Flush LSN     Replay LSN    Write Lag        Flush Lag        Replay Lag       State      Sync State  Sync Priority
</span></span><span style="display:flex;"><span>----       --------      ---------     ---------     ----------    ---------        ---------        ----------       -----      ----------  -------------
</span></span><span style="display:flex;"><span>sandbox-1  3AF/EB0524F0  3AF/EB011760  3AF/EAFEDE50  3AF/EAFEDE50  00:00:00.004461  00:00:00.007901  00:00:00.007901  streaming  quorum      <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>sandbox-3  3AF/EB0524F0  3AF/EB030B00  3AF/EB030B00  3AF/EB011760  00:00:00.000977  00:00:00.004194  00:00:00.008252  streaming  quorum      <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Instances status
</span></span><span style="display:flex;"><span>Name       Database Size  Current LSN   Replication role  Status  QoS         Manager Version
</span></span><span style="display:flex;"><span>----       -------------  -----------   ----------------  ------  ---         ---------------
</span></span><span style="display:flex;"><span>sandbox-1  <span style="color:#ae81ff">302</span> GB         3AF/E9FFFFE0  Standby <span style="color:#f92672">(</span>sync<span style="color:#f92672">)</span>    OK      Guaranteed  1.11.0
</span></span><span style="display:flex;"><span>sandbox-2  <span style="color:#ae81ff">302</span> GB         3AF/EAFA6168  Primary           OK      Guaranteed  1.11.0
</span></span><span style="display:flex;"><span>sandbox-3  <span style="color:#ae81ff">302</span> GB         3AF/EBAD5D18  Standby <span style="color:#f92672">(</span>sync<span style="color:#f92672">)</span>    OK      Guaranteed  1.11.0
</span></span></code></pre></div><p>You can also get a more verbose version of the status by adding <code>--verbose</code> or just <code>-v</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp status sandbox --verbose
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Cluster in healthy state
</span></span><span style="display:flex;"><span>Name:               sandbox
</span></span><span style="display:flex;"><span>Namespace:          default
</span></span><span style="display:flex;"><span>System ID:          <span style="color:#ae81ff">7039966298120953877</span>
</span></span><span style="display:flex;"><span>PostgreSQL Image:   quay.io/enterprisedb/postgresql:14.1
</span></span><span style="display:flex;"><span>Primary instance:   sandbox-2
</span></span><span style="display:flex;"><span>Instances:          <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Ready instances:    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Current Write LSN:  3B1/61DE3158 <span style="color:#f92672">(</span>Timeline: <span style="color:#ae81ff">8</span> - WAL File: 00000008000003B100000030<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PostgreSQL Configuration
</span></span><span style="display:flex;"><span>archive_command <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/manager wal-archive --log-destination /controller/log/postgres.json %p&#39;</span>
</span></span><span style="display:flex;"><span>archive_mode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>archive_timeout <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;5min&#39;</span>
</span></span><span style="display:flex;"><span>checkpoint_completion_target <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;0.9&#39;</span>
</span></span><span style="display:flex;"><span>checkpoint_timeout <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;900s&#39;</span>
</span></span><span style="display:flex;"><span>cluster_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sandbox&#39;</span>
</span></span><span style="display:flex;"><span>dynamic_shared_memory_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sysv&#39;</span>
</span></span><span style="display:flex;"><span>full_page_writes <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>hot_standby <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;true&#39;</span>
</span></span><span style="display:flex;"><span>jit <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>listen_addresses <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>
</span></span><span style="display:flex;"><span>log_autovacuum_min_duration <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1s&#39;</span>
</span></span><span style="display:flex;"><span>log_checkpoints <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>log_destination <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;csvlog&#39;</span>
</span></span><span style="display:flex;"><span>log_directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/log&#39;</span>
</span></span><span style="display:flex;"><span>log_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;postgres&#39;</span>
</span></span><span style="display:flex;"><span>log_lock_waits <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>log_min_duration_statement <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1000&#39;</span>
</span></span><span style="display:flex;"><span>log_rotation_age <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;0&#39;</span>
</span></span><span style="display:flex;"><span>log_rotation_size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;0&#39;</span>
</span></span><span style="display:flex;"><span>log_statement <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ddl&#39;</span>
</span></span><span style="display:flex;"><span>log_temp_files <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1024&#39;</span>
</span></span><span style="display:flex;"><span>log_truncate_on_rotation <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;false&#39;</span>
</span></span><span style="display:flex;"><span>logging_collector <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>maintenance_work_mem <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2GB&#39;</span>
</span></span><span style="display:flex;"><span>max_connections <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1000&#39;</span>
</span></span><span style="display:flex;"><span>max_parallel_workers <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;32&#39;</span>
</span></span><span style="display:flex;"><span>max_replication_slots <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;32&#39;</span>
</span></span><span style="display:flex;"><span>max_wal_size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;15GB&#39;</span>
</span></span><span style="display:flex;"><span>max_worker_processes <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;32&#39;</span>
</span></span><span style="display:flex;"><span>pg_stat_statements.max <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;10000&#39;</span>
</span></span><span style="display:flex;"><span>pg_stat_statements.track <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;all&#39;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;5432&#39;</span>
</span></span><span style="display:flex;"><span>shared_buffers <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;16GB&#39;</span>
</span></span><span style="display:flex;"><span>shared_memory_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sysv&#39;</span>
</span></span><span style="display:flex;"><span>shared_preload_libraries <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;pg_stat_statements&#39;</span>
</span></span><span style="display:flex;"><span>ssl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>ssl_ca_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/certificates/client-ca.crt&#39;</span>
</span></span><span style="display:flex;"><span>ssl_cert_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/certificates/server.crt&#39;</span>
</span></span><span style="display:flex;"><span>ssl_key_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/certificates/server.key&#39;</span>
</span></span><span style="display:flex;"><span>synchronous_standby_names <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ANY 1 (&#34;sandbox-1&#34;,&#34;sandbox-3&#34;)&#39;</span>
</span></span><span style="display:flex;"><span>unix_socket_directories <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/controller/run&#39;</span>
</span></span><span style="display:flex;"><span>wal_keep_size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;512MB&#39;</span>
</span></span><span style="display:flex;"><span>wal_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;logical&#39;</span>
</span></span><span style="display:flex;"><span>wal_log_hints <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>
</span></span><span style="display:flex;"><span>cnp.config_sha256 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;3cfa683e23fe513afaee7c97b50ce0628e0cc634bca8b096517538a9a4428efc&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PostgreSQL HBA Rules
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Grant local access</span>
</span></span><span style="display:flex;"><span>local all all peer map<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Require client certificate authentication for the streaming_replica user</span>
</span></span><span style="display:flex;"><span>hostssl postgres streaming_replica all cert
</span></span><span style="display:flex;"><span>hostssl replication streaming_replica all cert
</span></span><span style="display:flex;"><span>hostssl all cnp_pooler_pgbouncer all cert
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Otherwise use the default authentication method</span>
</span></span><span style="display:flex;"><span>host all all all scram-sha-256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Continuous Backup status
</span></span><span style="display:flex;"><span>First Point of Recoverability:  Not Available
</span></span><span style="display:flex;"><span>Working WAL archiving:          OK
</span></span><span style="display:flex;"><span>Last Archived WAL:              00000008000003B00000001D   @   2021-12-14T10:20:42.272815Z
</span></span><span style="display:flex;"><span>Last Failed WAL: -
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Streaming Replication status
</span></span><span style="display:flex;"><span>Name       Sent LSN      Write LSN     Flush LSN     Replay LSN    Write Lag        Flush Lag        Replay Lag       State      Sync State  Sync Priority
</span></span><span style="display:flex;"><span>----       --------      ---------     ---------     ----------    ---------        ---------        ----------       -----      ----------  -------------
</span></span><span style="display:flex;"><span>sandbox-1  3B1/61E26448  3B1/61DF82F0  3B1/61DF82F0  3B1/61DF82F0  00:00:00.000333  00:00:00.000333  00:00:00.005484  streaming  quorum      <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>sandbox-3  3B1/61E26448  3B1/61E26448  3B1/61DF82F0  3B1/61DF82F0  00:00:00.000756  00:00:00.000756  00:00:00.000756  streaming  quorum      <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Instances status
</span></span><span style="display:flex;"><span>Name       Database Size  Current LSN   Replication role  Status  QoS         Manager Version
</span></span><span style="display:flex;"><span>----       -------------  -----------   ----------------  ------  ---         ---------------
</span></span><span style="display:flex;"><span>sandbox-1                 3B1/610204B8  Standby <span style="color:#f92672">(</span>sync<span style="color:#f92672">)</span>    OK      Guaranteed  1.11.0
</span></span><span style="display:flex;"><span>sandbox-2                 3B1/61DE3158  Primary           OK      Guaranteed  1.11.0
</span></span><span style="display:flex;"><span>sandbox-3                 3B1/62618470  Standby <span style="color:#f92672">(</span>sync<span style="color:#f92672">)</span>    OK      Guaranteed  1.11.0
</span></span></code></pre></div><p>The command also supports output in <code>yaml</code> and <code>json</code> format.</p>
<h3 id="promote">Promote</h3>
<p>The meaning of this command is to <code>promote</code> a pod in the cluster to primary, so you
can start with maintenance work or test a switch-over situation in your cluster</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp promote cluster-example cluster-example-2
</span></span></code></pre></div><p>Or you can use the instance node number to promote</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp promote cluster-example <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h3 id="certificates">Certificates</h3>
<p>Clusters created using the Cloud Native PostgreSQL operator work with a CA to sign
a TLS authentication certificate.</p>
<p>To get a certificate, you need to provide a name for the secret to store
the credentials, the cluster name, and a user for this certificate</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp certificate cluster-cert --cnp-cluster cluster-example --cnp-user appuser
</span></span></code></pre></div><p>After the secrete it&rsquo;s created, you can get it using <code>kubectl</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get secret cluster-cert
</span></span></code></pre></div><p>And the content of the same in plain text using the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get secret cluster-cert -o json | jq -r <span style="color:#e6db74">&#39;.data | map(@base64d) | .[]&#39;</span>
</span></span></code></pre></div><h3 id="restart">Restart</h3>
<p>The <code>kubectl cnp restart</code> command requests the operator to orchestrate
a rollout restart for a certain cluster. This is useful to apply
configuration changes to cluster dependent objects, such as ConfigMaps
containing custom monitoring queries.</p>
<p>The following command will restart a given cluster in a rollout fashion:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp restart <span style="color:#f92672">[</span>cluster_name<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>!!! Note
If you want ConfigMaps and Secrets to be <strong>automatically</strong> reloaded by instances, you can
add a label with key <code>k8s.enterprisedb.io/reload</code> to it.</p>
<h3 id="reload">Reload</h3>
<p>The <code>kubectl cnp reload</code> command requests the operator to trigger a reconciliation
loop for a certain cluster. This is useful to apply configuration changes
to cluster dependent objects, such as ConfigMaps containing custom monitoring queries.</p>
<p>The following command will reload all configurations for a given cluster:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl cnp reload <span style="color:#f92672">[</span>cluster_name<span style="color:#f92672">]</span>
</span></span></code></pre></div>


    <footer class="text-center p-24">
    <div>
        <a href="#" class="bg-rose-600 py-4 px-12 rounded-full text-white text-xl">View on GitHub</a>
    </div>
    <p class="text-sm text-slate-600 w-1/2 mx-auto pt-10">&copy; 2019-2022 The CloudNativePG Contributors<br/>
    The Linux Foundation has registered trademarks and uses trademarks. 
    For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/" class="text-rose-600">Trademark Usage page</a>.<br/>
    Postgres, PostgreSQL and the Slonik Logo are trademarks or registered trademarks of the PostgreSQL Community Association of Canada, and used with their permission.
    </p>
</footer>

  </div>
  
  <script src="https://cdn.usefathom.com/script.js" data-site="GSMQCVAJ" defer></script>
  
</body>

</html>
<!DOCTYPE html>




<html lang="en">

<head>
  <title>CloudNative PG</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta name="description" content="CloudNativePG is the Kubernetes operator that covers the full lifecycle of a highly available PostgreSQL database cluster with a primary/standby architecture, using native streaming replication." />
  <meta name="keywords" content="" />
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" />
  <link href="/main.min.css" rel="stylesheet" />
</head>

<body>
  <div class="h-screen w-screen">
    
<main>
  <header>
    <div class="flex flex-row px-16 justify-between py-5">
      <div>
        
        <a href="/"><img src="/logo/large_logo.svg" class="h-14" alt="Cloud Native Postgres Logo"></a>
      </div>
      <div>
        <ul class="flex gap-14 text-2xl text-slate-400 my-5">
          <li><a href="/docs/1.15.0/" target="_blank">Documentation</a></li>
          <li>Support</li>
          <li>End users</li>
          <li>Blog</li>
        </ul>
      </div>
      <div class="flex gap-5 my-4">
        <a href="https://github.com/cloudnative-pg/cloudnative-pg">
          <img src="/icons/Git.svg" alt="Github">
        </a>
        <a href="https://cloudnativepg.slack.com/">
          <img src="/icons/Slack.svg" alt="Slack">
        </a>
        <a href="https://twitter.com/CloudNativePg">
          <img src="/icons/Twitter.svg" alt="Twitter">
        </a>
        <a href="https://www.youtube.com/channel/UCTGH88W1BiuRRPTzJUDPJyA">
          <img src="/icons/YouTube.svg" alt="YouTube">
        </a>
      </div>
    </div>
  </header>
</main>


    
<h2 class="text-2xl"></h2>
<h1 id="labels-and-annotations">Labels and annotations</h1>
<p>Resources in Kubernetes are organized in a flat structure, with no hierarchical
information or relationship between them. However, such resources and objects
can be linked together and put in relationship through <strong>labels</strong> and
<strong>annotations</strong>.</p>
<p>!!! info
For more information, please refer to the Kubernetes documentation on
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a> and
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">labels</a>.</p>
<p>In short:</p>
<ul>
<li>an annotation is used to assign additional non-identifying information to
resources with the goal to facilitate integration with external tools</li>
<li>a label is used to group objects and query them through Kubernetes&rsquo; native
selector capability</li>
</ul>
<p>You can select one or more labels and/or annotations you will use
in your Cloud Native PostgreSQL deployments. Then you need to configure the operator
so that when you define these labels and/or annotations in a cluster&rsquo;s metadata,
they are automatically inherited by all resources created by it (including pods).</p>
<p>!!! Note
Label and annotation inheritance is the technique adopted by Cloud Native
PostgreSQL in lieu of alternative approaches such as pod templates.</p>
<h2 id="pre-requisites">Pre-requisites</h2>
<p>By default, no label or annotation defined in the cluster&rsquo;s metadata is
inherited by the associated resources.
In order to enable label/annotation inheritance, you need to follow the
instructions provided in the <a href="operator_conf.md">&ldquo;Operator configuration&rdquo;</a> section.</p>
<p>Below we will continue on that example and limit it to the following:</p>
<ul>
<li>annotations: <code>categories</code></li>
<li>labels: <code>app</code>, <code>environment</code>, and <code>workload</code></li>
</ul>
<p>!!! Note
Feel free to select the names that most suit your context for both
annotations and labels. Remember that you can also use wildcards
in naming and adopt strategies like <code>mycompany/*</code> for all labels
or annotations starting with <code>mycompany/</code> to be inherited.</p>
<h2 id="defining-clusters-metadata">Defining cluster&rsquo;s metadata</h2>
<p>When defining the cluster, <strong>before</strong> any resource is deployed, you can
properly set the metadata as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">postgresql.k8s.enterprisedb.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cluster-example</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">categories</span>: <span style="color:#ae81ff">database</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>: <span style="color:#ae81ff">production</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">workload</span>: <span style="color:#ae81ff">database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">sso</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>     <span style="color:#75715e"># ... &lt;snip&gt;</span>
</span></span></code></pre></div><p>Once the cluster is deployed, you can verify, for example, that the labels
have been correctly set in the pods with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get pods --show-labels
</span></span></code></pre></div><h2 id="current-limitations">Current limitations</h2>
<p>Currently, Cloud Native PostgreSQL does not automatically propagate labels or
annotations deletions. Therefore, when an annotation or label is removed from
a Cluster, which was previously propagated to the underlying pods, the operator
will not automatically remove it on the associated resources.</p>



    <footer class="text-center p-24">
    <div>
        <a href="#" class="bg-rose-600 py-4 px-12 rounded-full text-white text-xl">View on GitHub</a>
    </div>
    <p class="text-sm text-slate-600 w-1/2 mx-auto pt-10">&copy; 2019-2022 The CloudNativePG Contributors<br/>
    The Linux Foundation has registered trademarks and uses trademarks. 
    For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/" class="text-rose-600">Trademark Usage page</a>.<br/>
    Postgres, PostgreSQL and the Slonik Logo are trademarks or registered trademarks of the PostgreSQL Community Association of Canada, and used with their permission.
    </p>
</footer>

  </div>
  
  <script src="https://cdn.usefathom.com/script.js" data-site="GSMQCVAJ" defer></script>
  
</body>

</html>
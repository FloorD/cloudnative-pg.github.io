<!DOCTYPE html>




<html lang="en">

<head>
  <title>CloudNative PG</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta name="description" content="CloudNativePG is the Kubernetes operator that covers the full lifecycle of a highly available PostgreSQL database cluster with a primary/standby architecture, using native streaming replication." />
  <meta name="keywords" content="" />
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" />
  <link href="/main.min.css" rel="stylesheet" />
  <link rel="favicon" href="/favicon/favicon.ico">
</head>

<body>
  <div class="h-screen w-screen">
    
<main>
  <header>
    <div class="flex flex-row px-16 justify-between py-5">
      <div>
        
        <a href="/"><img src="/logo/large_logo.svg" class="h-14" alt="Cloud Native Postgres Logo"></a>
      </div>
      <div>
        <ul class="flex gap-14 text-2xl text-slate-400 my-5">
          <li><a href="/docs/1.15.0/" target="_blank">Documentation</a></li>
          <li>Support</li>
          <li>End users</li>
          <li>Blog</li>
        </ul>
      </div>
      <div class="flex gap-5 my-4">
        <a href="https://github.com/cloudnative-pg/cloudnative-pg">
          <img src="/icons/Git.svg" alt="Github">
        </a>
        <a href="https://cloudnativepg.slack.com/">
          <img src="/icons/Slack.svg" alt="Slack">
        </a>
        <a href="https://twitter.com/CloudNativePg">
          <img src="/icons/Twitter.svg" alt="Twitter">
        </a>
        <a href="https://www.youtube.com/channel/UCTGH88W1BiuRRPTzJUDPJyA">
          <img src="/icons/YouTube.svg" alt="YouTube">
        </a>
      </div>
    </div>
  </header>
</main>


    
<h2 class="text-2xl"></h2>
<h1 id="quickstart">Quickstart</h1>
<p>This section describes how to test a PostgreSQL cluster on your laptop/computer
using Cloud Native PostgreSQL on a local Kubernetes cluster in
<a href="https://kubernetes.io/docs/setup/learning-environment/minikube/">Minikube</a> or
<a href="https://kind.sigs.k8s.io/">Kind</a>.</p>
<p>Red Hat OpenShift Container Platform users can test the certified operator for
Cloud Native PostgreSQL on the <a href="https://developers.redhat.com/products/codeready-containers/overview">Red Hat CodeReady Containers (CRC)</a>
for OpenShift.</p>
<p>!!! Warning
The instructions contained in this section are for demonstration,
testing, and practice purposes only and must not be used in production.</p>
<p>Like any other Kubernetes application, Cloud Native PostgreSQL is deployed using
regular manifests written in YAML.</p>
<p>By following the instructions on this page you should be able to start a PostgreSQL
cluster on your local Kubernetes/Openshift installation and experiment with it.</p>
<p>!!! Important
Make sure that you have <code>kubectl</code> installed on your machine in order
to connect to the Kubernetes cluster, or <code>oc</code> if using CRC for OpenShift.
Please follow the Kubernetes documentation on <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">how to install <code>kubectl</code></a>
or the Openshift one on <a href="https://docs.openshift.com/container-platform/4.6/cli_reference/openshift_cli/getting-started-cli.html">how to install <code>oc</code></a>.</p>
<p>!!! Note
If you are running Openshift, use <code>oc</code> every time <code>kubectl</code> is mentioned
in this documentation. <code>kubectl</code> commands are compatible with <code>oc</code> ones.</p>
<h2 id="part-1---setup-the-local-kubernetesopenshift-playground">Part 1 - Setup the local Kubernetes/Openshift playground</h2>
<p>The first part is about installing Minikube, Kind, or CRC. Please spend some time
reading about the systems and decide which one to proceed with.
After setting up one of them, please proceed with part 2.</p>
<h3 id="minikube">Minikube</h3>
<p>Minikube is a tool that makes it easy to run Kubernetes locally. Minikube runs a
single-node Kubernetes cluster inside a Virtual Machine (VM) on your laptop for
users looking to try out Kubernetes or develop with it day-to-day. Normally, it
is used in conjunction with VirtualBox.</p>
<p>You can find more information in the official <a href="https://kubernetes.io/docs/tasks/tools/install-minikube">Kubernetes documentation on how to
install Minikube</a> in your local personal environment.
When you installed it, run the following command to create a minikube cluster:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>minikube start
</span></span></code></pre></div><p>This will create the Kubernetes cluster, and you will be ready to use it.
Verify that it works with the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>kubectl get nodes
</span></span></code></pre></div><p>You will see one node called <code>minikube</code>.</p>
<h3 id="kind">Kind</h3>
<p>If you do not want to use a virtual machine hypervisor, then Kind is a tool for running
local Kubernetes clusters using Docker container &ldquo;nodes&rdquo; (Kind stands for &ldquo;Kubernetes IN Docker&rdquo; indeed).</p>
<p>Install <code>kind</code> on your environment following the instructions in the <a href="https://kind.sigs.k8s.io/docs/user/quick-start">Quickstart</a>,
then create a Kubernetes cluster with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>kind create cluster --name pg
</span></span></code></pre></div><h3 id="codeready-containers-crc">CodeReady Containers (CRC)</h3>
<p><a href="https://developers.redhat.com/products/codeready-containers/overview">Download Red Hat CRC</a>
and move the binary inside a directory in your <code>PATH</code>.</p>
<p>You can then run the following commands:</p>
<pre tabindex="0"><code>crc setup
crc start
</code></pre><p>The <code>crc start</code> output will explain how to proceed. You&rsquo;ll then need to
execute the output of the <code>crc oc-env</code> command.
After that, you can log in as <code>kubeadmin</code> with the printed <code>oc login</code>
command. You can also open the web console running <code>crc console</code>.
User and password are the same as for the <code>oc login</code> command.</p>
<p>CRC doesn&rsquo;t come with a StorageClass, so one has to be configured.
You can follow the <a href="https://github.com/code-ready/crc/wiki/Dynamic-volume-provisioning">Dynamic volume provisioning wiki page</a>
and install <code>rancher/local-path-provisioner</code>.</p>
<h2 id="part-2---install-cloud-native-postgresql">Part 2 - Install Cloud Native PostgreSQL</h2>
<p>Now that you have a Kubernetes or OpenShift installation up and running
on your laptop, you can proceed with Cloud Native PostgreSQL installation.</p>
<p>Please refer to the <a href="installation_upgrade.md">&ldquo;Installation&rdquo;</a> section and then proceed
with the deployment of a PostgreSQL cluster.</p>
<h2 id="part-3---deploy-a-postgresql-cluster">Part 3 - Deploy a PostgreSQL cluster</h2>
<p>As with any other deployment in Kubernetes, to deploy a PostgreSQL cluster
you need to apply a configuration file that defines your desired <code>Cluster</code>.</p>
<p>The <a href="samples/cluster-example.yaml"><code>cluster-example.yaml</code></a> sample file
defines a simple <code>Cluster</code> using the default storage class to allocate
disk space:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Example of PostgreSQL cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">postgresql.k8s.enterprisedb.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cluster-example</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">instances</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Example of rolling update strategy:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># - unsupervised: automated update of the primary once all</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#                 replicas have been upgraded (default)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># - supervised: requires manual supervision to perform</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#               the switchover of the primary</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">primaryUpdateStrategy</span>: <span style="color:#ae81ff">unsupervised</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Require 1Gi of space</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">storage</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">size</span>: <span style="color:#ae81ff">1Gi</span>
</span></span></code></pre></div><p>!!! Note &ldquo;There&rsquo;s more&rdquo;
For more detailed information about the available options, please refer
to the <a href="api_reference.md">&ldquo;API Reference&rdquo; section</a>.</p>
<p>In order to create the 3-node PostgreSQL cluster, you need to run the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>kubectl apply -f cluster-example.yaml
</span></span></code></pre></div><p>You can check that the pods are being created with the <code>get pods</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>kubectl get pods
</span></span></code></pre></div><p>By default, the operator will install the latest available minor version
of the latest major version of PostgreSQL when the operator was released.
You can override this by setting the <code>imageName</code> key in the <code>spec</code> section of
the <code>Cluster</code> definition. For example, to install PostgreSQL 12.5:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">postgresql.k8s.enterprisedb.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#75715e"># [...]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#75715e"># [...]</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">imageName</span>: <span style="color:#ae81ff">quay.io/enterprisedb/postgresql:12.5</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">#[...]</span>
</span></span></code></pre></div><p>!!! Important
The immutable infrastructure paradigm requires that you always
point to a specific version of the container image.
Never use tags like <code>latest</code> or <code>13</code> in a production environment
as it might lead to unpredictable scenarios in terms of update
policies and version consistency in the cluster.
For strict deterministic and repeatable deployments, you can add the digests
to the image name, through the <code>&lt;image&gt;:&lt;tag&gt;@sha256:&lt;digestValue&gt;</code> format.</p>



    <footer class="text-center p-24">
    <div>
        <a href="#" class="bg-rose-600 py-4 px-12 rounded-full text-white text-xl">View on GitHub</a>
    </div>
    <p class="text-sm text-slate-600 w-1/2 mx-auto pt-10">&copy; 2019-2022 The CloudNativePG Contributors<br/>
    The Linux Foundation has registered trademarks and uses trademarks. 
    For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/" class="text-rose-600">Trademark Usage page</a>.<br/>
    Postgres, PostgreSQL and the Slonik Logo are trademarks or registered trademarks of the PostgreSQL Community Association of Canada, and used with their permission.
    </p>
</footer>

  </div>
  
  <script src="https://cdn.usefathom.com/script.js" data-site="GSMQCVAJ" defer></script>
  
</body>

</html>